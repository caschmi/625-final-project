---
title: "625FinalPaper"
author: "Caitlin Seibel"
date: "2023-12-11"
output:
  pdf_document: default
  html_document:
    df_print: paged
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(gtsummary)
library(tableone)
dataFinal = read.csv("finalModelData.csv")
```

\section{Introduction}

```{r, echo=FALSE, message=FALSE}

dataFinal = na.omit(dataFinal)

dataFinal$Gender = ifelse(dataFinal$Gender == "M", "Male", "Female")
dataFinal$Ages = dataFinal$Age
dataFinal$Age = factor(dataFinal$Age, levels = unique(dataFinal$Age))

dataFinal$Race <- relevel(as.factor(dataFinal$Race), ref = "White")
dataFinal$Gender <- relevel(as.factor(dataFinal$Gender), ref = "Male")
dataFinal$Cause_of_Death <- relevel(as.factor(dataFinal$Cause_of_Death), ref = "All other non-drug and non-alcohol causes")
dataFinal$Age <- relevel(as.factor(dataFinal$Age), ref = "Under 5 years")
dataFinal$COVID <- as.factor(dataFinal$COVID)

dataFinal %>%
  select(Age, Cause_of_Death, Gender, Race) %>%
  tbl_summary(label = list(Cause_of_Death ~ "Cause of Death"))

kableone(CreateTableOne(data = dataFinal, vars = c("Deaths", "Cause_of_Death", "Age", "Race", "Gender", "COVID")))

```

\section{Methods}
\subsection{Data Preprocessing}


\subsection{Model Building}
To analyze our data, we choose a Generalized Linear Model (GLM). Our outcome variable of interest is number of deaths per month, referred to in our model simply as "Deaths". Our main predictor of interests are cause of death: drug related, alcohol related, or non-drug/alcohol related, and indicator of COVID-19 pandemic: 0 if before the start of the COVID-19 pandemic (defined here as March 2020), or 1 if after. Our other demographic covariates include age group, gender, and race. We also want to investigate the possible interaction between cause of death and the indicator of COVID-19 pandemic. Our outcome is a count variable so we initially assume a Poisson distribution. We use log(Population) as an offset for the model, since we want to model count rather than rate. Our initial GLM model is as follows.

$$ \hat{log(Deaths)} = \hat{\beta_0} + log(Population) + \hat{\beta_1} Cause + \hat{\beta_2} Gender + \hat{\beta_3} Age + \hat{\beta_4} Race + \hat{\beta_5} COVID + \hat{\beta_6} Cause \times COVID$$
Since we are using a Poisson distribution, we need to check for overdispersion, or a violation of the assumption of equal mean and variance. To check for this violation, we will run our model and calculate the deviance divided by the residual degrees of freedom. If the equal mean and variance assumption is met, we expect this value to be approximately 1. From our model, we calculate this metric as 111.4576, which is much larger than 1, so we have evidence of overdispersion. To account for this overdispersion, we will use a negative binomial outcome for our GLM.

\section{Results}


\section{Discussion}
